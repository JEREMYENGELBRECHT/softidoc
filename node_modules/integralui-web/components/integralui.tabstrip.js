/*
  filename: integralui.tabstrip.js
  version : 1.0.0
  Copyright Â© 2016-2017 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(e,b){function a(){this.constructor=e}for(var f in b)b.hasOwnProperty(f)&&(e[f]=b[f]);e.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)},__decorate=this&&this.__decorate||function(e,b,a,f){var c=arguments.length,d=3>c?b:null===f?f=Object.getOwnPropertyDescriptor(b,a):f,h;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=Reflect.decorate(e,b,a,f);else for(var l=e.length-1;0<=l;l--)if(h=e[l])d=(3>c?h(d):3<c?h(b,a,d):
h(b,a))||d;return 3<c&&d&&Object.defineProperty(b,a,d),d},__metadata=this&&this.__metadata||function(e,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,b)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),integralui_data_service_1=require("../services/integralui.data.service"),integralui_tab_1=require("./integralui.tab"),IntegralUITabStrip=function(e){function b(a,
b,c,d,h,l){e.call(this,d);this.dataService=a;this.elemRef=b;this.elemRenderer=c;this.commonService=d;this.cmpResolver=h;this.baseService=l;this.eventList=[];this.numTabs=0;this.currentTabPlacement=integralui_core_1.IntegralUITabStripPlacement.Top;this.blockPos={top:"0",right:"auto",bottom:"auto",left:"0"};this.tabSize={width:0,height:0};this.currentSelection=null;this.currentSelectedIndex=-1;this.prevComponent=this.selectedComponent=null;this.removeIndex=-1;this.trialRef=null;this.tabSpacing=0;this.afterSelect=
new core_1.EventEmitter;this.beforeSelect=new core_1.EventEmitter;this.tabAdding=new core_1.EventEmitter;this.tabAdded=new core_1.EventEmitter;this.clear=new core_1.EventEmitter;this.tabRemoving=new core_1.EventEmitter;this.tabRemoved=new core_1.EventEmitter;this.selectionChanged=new core_1.EventEmitter;this.tabList=[]}__extends(b,e);Object.defineProperty(b.prototype,"selectedIndex",{get:function(){return this.currentSelectedIndex},set:function(a){this.currentSelectedIndex!=a&&(this.currentSelectedIndex=
a,this.selectComponentByIndex(a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedTab",{get:function(){return this.currentSelection},set:function(a){this.currentSelection!=a&&(this.currentSelection=a,this.selectTab(a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"tabStripPlacement",{get:function(){return this.currentTabPlacement},set:function(a){this.currentTabPlacement!=a&&(this.currentTabPlacement=a,this.updateLayout())},enumerable:!0,configurable:!0});
b.prototype.ngOnInit=function(){this.baseService.setComponent(this);this.dataService.init([{data:this.tabs}]);this.generalClassName="iui-tabstrip";this.tabHeaderClassName="iui-tab-header";this.initStyle()};b.prototype.ngAfterViewInit=function(){var a=this,b=setTimeout(function(){var f=a.cmpResolver.resolveComponentFactory(integralui_core_1.IntegralUITComponent);f&&a.tabBlockRef&&(a.trialRef=a.tabBlockRef.createComponent(f));clearTimeout(b)},100)};b.prototype.ngAfterContentInit=function(){this.tabList=
this.contentList.toArray();this.numTabs=this.tabList.length;0<this.numTabs&&(0<=this.selectedIndex?this.selectComponentByIndex(this.selectedIndex):this.selectedTab&&this.tabs?this.selectComponentByIndex(this.tabs.indexOf(this.selectedTab)):this.selectComponentByIndex(0));this.updateLayout()};b.prototype.ngOnDestroy=function(){this.trialRef&&this.trialRef.destroy()};b.prototype.addTab=function(a){this.callEventAdd("add",a)};b.prototype.clearTabs=function(){this.dataService.clear();this.clear.emit(null)};
b.prototype.insertTabAt=function(a,b){this.callEventAdd("at",a,b)};b.prototype.insertTabBefore=function(a,b){this.callEventAdd("ref",a,-1,b)};b.prototype.insertTabAfter=function(a,b){this.callEventAdd("ref",a,-1,b,!0)};b.prototype.removeTab=function(a){this.callEventRemove(a)};b.prototype.removeTabAt=function(a){this.tabs&&0<=a&&a<this.tabs.length&&this.callEventRemove(this.tabs[a])};b.prototype.callEventAdd=function(a,b,c,d,h){var f={cancel:!1,tab:b};this.tabAdding.emit(f);if(1!=f.cancel){switch(a){case "at":this.dataService.insert(b,
c);break;case "ref":this.dataService.insertByRef(b,d,h);break;default:this.dataService.insert(b)}this.tabAdded.emit({tab:b});this.selectedComponent||this.selectComponentByIndex(0)}};b.prototype.callEventRemove=function(a){var b={cancel:!1,tab:a};this.tabRemoving.emit(b);1!=b.cancel&&(this.removeIndex=this.tabs?this.tabs.indexOf(a):-1,this.dataService.removeAt(a),this.tabRemoved.emit({tab:a}))};b.prototype.attachTabEvents=function(){};b.prototype.getTabCurrentIndex=function(a){this.tabList=this.contentList.toArray();
return a&&this.tabList?this.tabList.indexOf(a):-1};b.prototype.getTabDataIndex=function(a){return a&&(a=this.getTabCurrentIndex(a),this.tabs&&0<=a&&a<this.tabs.length)?a:-1};b.prototype.getTabData=function(a){return this.tabs&&0<=a&&a<this.tabs.length?this.tabs[a]:null};b.prototype.getTabIndex=function(a){return a&&this.tabs?this.tabs.indexOf(a):-1};b.prototype.getComponentData=function(a){if(a){if(a.data)return a.data;a=this.getTabDataIndex(a);if(this.tabs&&0<=a&&a<this.tabs.length)return this.tabs[a]}return null};
b.prototype.isIndexInRange=function(a){this.contentList&&(this.tabList=this.contentList.toArray());return this.tabList?0<=a&&a<this.tabList.length:!1};b.prototype.updateLayout=function(){this.updateTabLayout()};b.prototype.updateTabLayout=function(){var a=this,b=setTimeout(function(){a.tabList=a.contentList.toArray();if(a.tabHeaders){var f=0,d=0,h=0,e=0,m={top:0,left:0},n={width:0,height:0};a.tabSize={width:0,height:0};var p=a.tabHeaders.toArray();if(p&&0<p.length){p.forEach(function(b,c){h=b.nativeElement.offsetWidth;
e=b.nativeElement.offsetHeight;var k=a.commonService.getPadding(b.nativeElement);switch(a.currentTabPlacement){case integralui_core_1.IntegralUITabStripPlacement.Right:a.blockPos={top:"0",right:"0",bottom:"auto",left:"auto"};a.elemRenderer.setElementStyle(b.nativeElement,"top",d+"px");a.elemRenderer.setElementStyle(b.nativeElement,"right","0");a.elemRenderer.setElementStyle(b.nativeElement,"bottom","auto");a.elemRenderer.setElementStyle(b.nativeElement,"left","auto");a.tabSize.width<h&&(a.tabSize.width=
h-(k.left+k.right)-1);break;case integralui_core_1.IntegralUITabStripPlacement.Bottom:a.blockPos={top:"auto",right:"auto",bottom:"0",left:"0"};a.elemRenderer.setElementStyle(b.nativeElement,"top","auto");a.elemRenderer.setElementStyle(b.nativeElement,"right","auto");a.elemRenderer.setElementStyle(b.nativeElement,"bottom","0");a.elemRenderer.setElementStyle(b.nativeElement,"left",f+"px");a.tabSize.height<e&&(a.tabSize.height=e-(k.top+k.bottom));break;case integralui_core_1.IntegralUITabStripPlacement.Left:a.blockPos=
{top:"0",right:"auto",bottom:"auto",left:"0"};a.elemRenderer.setElementStyle(b.nativeElement,"top",d+"px");a.elemRenderer.setElementStyle(b.nativeElement,"right","auto");a.elemRenderer.setElementStyle(b.nativeElement,"bottom","auto");a.elemRenderer.setElementStyle(b.nativeElement,"left","0");a.tabSize.width<h&&(a.tabSize.width=h-(k.left+k.right)-1);break;default:a.blockPos={top:"0",right:"auto",bottom:"auto",left:"0"},a.elemRenderer.setElementStyle(b.nativeElement,"top","0"),a.elemRenderer.setElementStyle(b.nativeElement,
"right","auto"),a.elemRenderer.setElementStyle(b.nativeElement,"bottom","auto"),a.elemRenderer.setElementStyle(b.nativeElement,"left",f+"px"),a.tabSize.height<e&&(a.tabSize.height=e)}k=a.tabSpacing;f+=h+k-1;d+=e+k-1});var g=a.commonService.getBorderWidth(a.elemRef.nativeElement.children[0]);p.forEach(function(b,f){var c=a.commonService.getPadding(b.nativeElement);switch(a.currentTabPlacement){case integralui_core_1.IntegralUITabStripPlacement.Right:a.elemRenderer.setElementStyle(b.nativeElement,"width",
a.tabSize.width+"px");m={top:0,left:0};n={width:a.elemRef.nativeElement.children[0].clientWidth-(g.left+g.right-1)-a.tabSize.width-(c.left+c.right)-2,height:a.elemRef.nativeElement.children[0].clientHeight-(g.top+g.bottom)};break;case integralui_core_1.IntegralUITabStripPlacement.Bottom:a.elemRenderer.setElementStyle(b.nativeElement,"height",a.tabSize.height+"px");m={top:0,left:0};n={width:a.elemRef.nativeElement.children[0].clientWidth-(g.left+g.right),height:a.elemRef.nativeElement.children[0].clientHeight-
a.tabSize.height-(c.top+c.bottom)-2-(g.top+g.bottom-1)};break;case integralui_core_1.IntegralUITabStripPlacement.Left:a.elemRenderer.setElementStyle(b.nativeElement,"width",a.tabSize.width+"px");m={top:0,left:a.tabSize.width+(c.left+c.right)+1};n={width:a.elemRef.nativeElement.children[0].clientWidth-(g.left+g.right-1)-a.tabSize.width-(c.left+c.right)-2,height:a.elemRef.nativeElement.children[0].clientHeight-(g.top+g.bottom)};break;default:m={top:a.tabSize.height-1,left:0},n={width:a.elemRef.nativeElement.children[0].clientWidth-
(g.left+g.right),height:a.elemRef.nativeElement.children[0].clientHeight-a.tabSize.height-(g.top+g.bottom-1)}}})}a.tabList&&0<a.tabList.length&&a.tabList.forEach(function(a){a.updateLayout(m,n)})}clearTimeout(b)},1)};b.prototype.tabClicked=function(a,b){this.selectComponent(b)};b.prototype.tabEnter=function(a,b){b.selected||(b.state|=integralui_core_1.IntegralUIObjectState.hovered)};b.prototype.tabLeave=function(a,b){b.state&=~integralui_core_1.IntegralUIObjectState.hovered};b.prototype.clearSelection=
function(a){this.tabList=this.contentList.toArray();this.tabList.forEach(function(b,c){b!=a&&(b.selected=!1)})};b.prototype.selectComponent=function(a){if(a&&a!=this.selectedComponent){var b=this.getTabCurrentIndex(a),c=this.getComponentData(a),d={cancel:!1,index:b,tab:c};this.beforeSelect.emit(d);if(1!=d.cancel)return this.currentSelectedIndex=b,this.tabs&&0<=b&&b<this.tabs.length&&(this.currentSelection=this.tabs[b]),this.prevComponent=this.selectedComponent,this.selectedComponent=a,this.clearSelection(a),
a.selected=!0,this.afterSelect.emit({index:b,tab:c}),this.selectionChanged.emit({index:b,tab:c}),!0}return!1};b.prototype.selectComponentByIndex=function(a){this.isIndexInRange(a)&&this.selectComponent(this.tabList[a])};b.prototype.selectTab=function(a){this.tabs&&(this.currentSelectedIndex=this.tabs.indexOf(a),this.selectComponentByIndex(this.currentSelectedIndex))};b.prototype.getTabHeaderClass=function(a){var b=a.getCurrentTabStyle(),c=b.header.normal;if(a.state&integralui_core_1.IntegralUIObjectState.disabled)c+=
" "+b.header.disabled;else if(a.state&integralui_core_1.IntegralUIObjectState.focused)c+=" "+b.header.focused;else if(a.state&integralui_core_1.IntegralUIObjectState.selected)switch(c+=" "+b.header.selected,this.currentTabPlacement){case integralui_core_1.IntegralUITabStripPlacement.Right:c+=" iui-tab-selected-right";break;case integralui_core_1.IntegralUITabStripPlacement.Bottom:c+=" iui-tab-selected-bottom";break;case integralui_core_1.IntegralUITabStripPlacement.Left:c+=" iui-tab-selected-left";
break;default:c+=" iui-tab-selected-top"}else a.state&integralui_core_1.IntegralUIObjectState.hovered&&(c+=" "+b.header.hovered);return c};__decorate([core_1.ContentChildren(integralui_tab_1.IntegralUITab),__metadata("design:type",core_1.QueryList)],b.prototype,"contentList",void 0);__decorate([core_1.ViewChild("tabBlock"),__metadata("design:type",core_1.ElementRef)],b.prototype,"tabBlock",void 0);__decorate([core_1.ViewChild("tabBlock",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],
b.prototype,"tabBlockRef",void 0);__decorate([core_1.ViewChildren("tabHeader"),__metadata("design:type",core_1.QueryList)],b.prototype,"tabHeaders",void 0);__decorate([core_1.Input(),__metadata("design:type",Array)],b.prototype,"tabs",void 0);__decorate([core_1.Input(),__metadata("design:type",Number)],b.prototype,"tabSpacing",void 0);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],b.prototype,"selectedIndex",null);__decorate([core_1.Input(),__metadata("design:type",
Object),__metadata("design:paramtypes",[Object])],b.prototype,"selectedTab",null);__decorate([core_1.Input(),__metadata("design:type",Number),__metadata("design:paramtypes",[Number])],b.prototype,"tabStripPlacement",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"afterSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"beforeSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],
b.prototype,"tabAdding",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"tabAdded",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"clear",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"tabRemoving",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],b.prototype,"tabRemoved",void 0);__decorate([core_1.Output(),__metadata("design:type",
core_1.EventEmitter)],b.prototype,"selectionChanged",void 0);return b=__decorate([core_1.Component({selector:"iui-tabstrip",template:'\n\t\t<div [ngClass]="getControlClass()">\n\t\t\t<ul [ngStyle]="{ \'top\': blockPos.top , \'right\': blockPos.right, \'bottom\': blockPos.bottom, \'left\': blockPos.left }" #tabBlock>\n\t\t\t\t<li *ngFor="let tab of tabList" (mouseenter)="tabEnter($event, tab)" (mouseleave)="tabLeave($event, tab)" (mousedown)="tabClicked($event, tab)" [ngClass]="getTabHeaderClass(tab)" [ngStyle]="{ \'z-index\': tab.elemOrder }" #tabHeader>\n\t\t\t\t\t<span *ngIf="tab.icon" [ngClass]="tab.icon"></span>\n\t\t\t\t    <span *ngIf="tab.text" class="iui-tab-label">{{tab.text}}</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<ng-content></ng-content>\n\t\t</div>\n\t',
inputs:["controlStyle","data","state"],providers:[integralui_core_1.IntegralUIBaseService,integralui_data_service_1.IntegralUIDataService],encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[integralui_data_service_1.IntegralUIDataService,core_1.ElementRef,core_1.Renderer,integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],b)}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUITabStrip=IntegralUITabStrip;