<div loading-widget is-include="true">
    <ol class="breadcrumb">
        <li ng-repeat="item in historyItems"><a href ng-click="activateBreadCrumb(item)"><strong>{{item.Name}}</strong></a></li>
        <li class="active"><strong>{{activeBreadCrumb.Name}}</strong></li>
    </ol>
    <span class="h4"><strong>{{CurrentLocation}}</strong></span>
    <div class="col-xs-5 col-sm-5 col-md-5 col-lg-4 panel panel-default" ng-show="selectedRole == null">
        <table class="table table-hover table-condensed">
            <thead>
                <tr class="active text-muted">
                    <th class="h4">
                        Name
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr style="cursor: pointer" ng-repeat="item in userBaskets" ng-click="selectRole(item)">
                    <td class="h6"><strong class="text-info">{{item.Role}}</strong></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="col-xs-5 col-sm-5 col-md-5 col-lg-4 panel panel-default" ng-show="selectedRole != null && selectedTaskQueue == null">

        <table class="table table-hover table-condensed table-striped">
            <thead>
                <tr>
                    <td colspan="2"><a class="btn btn-sm btn-primary" ng-click="refresh()"><span class="glyphicon glyphicon-refresh"></span></a></td>
                </tr>
                <tr class="active text-muted">
                    <th class="h4" ng-if="hasClaimableQueues">
                        Available
                    </th>
                    <th class="h4">
                        Name
                    </th>
                    <th class="h4">Active</th>
                </tr>
            </thead>
            <tbody>
                <tr style="cursor: pointer" ng-repeat="item in selectedRole.TaskBaskets | orderBy:'TaskTemplateName'" ng-click="selectTaskQueue(item)">
                    <td class="h6" ng-if="hasClaimableQueues">
                        <button tooltip="{{item.AvailableCount}} available tasks to claim" ng-if="item.TaskResponsibilityId != 7" type="button" class="btn btn-sm" ng-disabled="item.AvailableCount == 0" ng-class="item.AvailableCount > 0 ? 'btn-primary' : 'btn-info'" ng-click="claimTask(item); $event.stopPropagation();">
                            <span class="badge">{{item.AvailableCount}}</span>
                        </button>
                    </td>
                    <td class="h6"><strong class="text-info">{{item.TaskTemplateName}}</strong></td>
                    <td class="h6 text-info"><span class="badge" ng-class="item.ActiveCount == 0 ? 'badge-outline' : 'badge-outline-bold'" tooltip="{{item.ActiveCount}} active tasks">{{item.ActiveCount}}</span></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="col-xs-5 col-sm-5 col-md-5 col-lg-4 panel panel-default" ng-show="selectedTaskQueue != null">
        <table class="table table-hover  table-striped">
            <thead>
            <tr class="active text-muted">
                <th class="h4">
                    Name
                </th>
                <th class="h4"></th>
            </tr>
            </thead>
            <tbody>
            <tr style="cursor: pointer" ng-repeat="item in taskStatusList | orderBy:'Order'" ng-click="selectQueue(item)">
                <td class="h6"><strong class="text-info">{{item.Status}}</strong></td>
                <td class="h6 text-info"><span class="badge pull-right" ng-class="item.Total == 0 ? 'badge-outline' : 'badge-outline-bold'" tooltip="Active Count">{{item.Total}}</span></td>
            </tr>
            <tr ng-show="searchConfiguration">
                <td colspan="2" class="h6">
                    <h3>Find tasks</h3>
                </td>
            </tr>
            <tr ng-show="searchConfiguration">
                <td colspan="2" class="h6">
                    <div>
                        <input ng-model="searchText" onkeypress="return allowOnlyNumbersLettersAndPeriod(event)" class="form-control" />
                    </div>
                    <div>
                        <br/>For this task, you can search on:<br/>
                        <ul><li ng-repeat="item in searchConfiguration.SearchableFields">{{item}}</li></ul>
                    </div>
                    <div><br/><button class="btn btn-primary pull-right" ng-click="searchTasks()">Search and go</button><br/>
                        <b>Note: </b>If there is more than one result, then you will be provided with the list.
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="col-xs-7 col-sm-7 col-md-7 col-lg-8 panel panel-default" ng-show="showSearchResults">
        <div class="alert alert-info">
            <span>No Tasks Match Your Search</span>
        </div>
    </div>
    <div class="col-xs-7 col-sm-7 col-md-7 col-lg-8 panel panel-default" ng-show="shouldShowEmptyTaskList()">
        <div class="alert alert-info">
            <span>No Tasks Available</span>
        </div>
    </div>
    <div class="col-xs-7 col-sm-7 col-md-7 col-lg-8 panel panel-default" ng-show="searchResults.Results.length > 0">
        <h3>Search Results for {{searchText}}</h3>
        <table class="table table-striped table-hover  table-striped">
            <thead>
            <tr class="text-muted active">
                <th class="">Created</th>
                <th class="">Modified</th>
                <th></th>
            </tr>
            </thead>
            <tbody>

            <tr style="cursor: pointer" ng-repeat="item in searchResults.Results | orderBy:'CreatedTimeStamp':false" ng-click="navigateToTask(item.Id,searchResults.Queue)">
                <td class=""><small class="text-muted">{{item.CreatedTimestamp | stdDateTime}}</small></td>
                <td class=""><small class="text-muted">{{item.ModifiedTimestamp | stdDateTime}}</small></td>
                <td class=""><span class="glyphicon glyphicon-chevron-right pull-right text-info"></span></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="col-xs-7 col-sm-7 col-md-7 col-lg-8 panel panel-default" ng-show="shouldShowTaskList()">
        <table class="table table-striped table-hover  table-striped">
            <thead>
                <tr class="text-muted active">
                    <th class=""></th>
                    <th class="hidden-md hidden-sm hidden-xs" ng-repeat="displayField in taskQueueFields">{{displayField.Label}}</th>
                    <th class="">Created</th>
                    <th class="">Modified</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>

                <tr style="cursor: pointer" ng-repeat="item in selectedQueueData | orderBy:'Created':false" ng-click="selectTask(item)">
                    <td>
                        <small style="padding-right: 10px;" class="glyphicon glyphicon-question-sign text-info" tooltip="{{item.Description}}"></small>
                    </td>
                    <td class="hidden-md hidden-sm hidden-xs" ng-repeat="displayField in taskQueueFields"><strong class="text-info" ng-bind="getFieldValue(item.DisplayMetadata,displayField.MappedValue);"></strong></td>
                    <td class=""><small class="text-muted">{{item.Created}}</small></td>
                    <td class=""><small class="text-muted">{{item.Modified}}</small></td>
                    <td class=""><span class="glyphicon glyphicon-chevron-right pull-right text-info"></span></td>
                </tr>
            </tbody>
        </table>
        <div style="text-align: center">
            <pagination total-items="totalItems" page="currentPage" items-per-page="itemsPerPage" max-size="maxSize" class="pagination-sm" boundary-links="true" rotate="false" ng-click="setPage(currentPage)"></pagination>
        </div>
    </div>
</div>